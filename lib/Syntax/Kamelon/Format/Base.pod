=head1 NAME

Syntax::Kamelon::Format::Base

=head1 SYNOPSIS

=head1 DESCRIPTION

B<Syntax::Kamelon::Format::Base> provides a basic formatting interface to B<Syntax::Kamelon>. You do not have to create an instance of
B<Base> yourself. B<Kamelon> will do that for you. During the parsing process it collects all the parsing information from B<Kamelon> 
through the B<Parse> method. When all information is collected you can start the formatting through the B<Format> method.

=head1 OPTIONS

=over 4

The constructor is called with a paired list of options as parameters. You can use
the following options.

=item B<folding> integer

This option specifies if the code folding mechanism in B<Kamelon> should be activated and to which nesting depth you
want code folding to be detected. If you set it to 0 the codefolding routines are not loaded. With any other value they
are and parsing speed will be lower. If you set it to 1 only the top folds will be passed on to the formatter, making it 
ideal to create an indexed document. If you want all code folding points detected, set it to a high value, like 999 or so.
The default value is 0.

=item B<format_table> => ref to hash

If you use the B<HighlightAndFormat> method, every attribute tag expects a reference of a list with two values. 
The first one is parsed before the matched text. The second one is parsed after the matched text.

If you know which attributes are used by the syntax definition files you are using you do not have
to specify all. If you want to play it safe, specify all available attribute tags.

If you do not specify this option, Kamelon will return the attribute tag name.

The following attribute tags are available:

 Alert              Annotation          Attribute           BaseN
 BuiltIn            Char                Comment             CommentVar
 Constant           ControlFlow         DataType            DecVal
 Documentation      Error               Extension           Float
 Function           Import              Information         Keyword
 Normal             Operator            Others              Preprocessor
 RegionMarker       SpecialChar         SpecialString       String
 Variable           VerbatimString      Warning

The syntax definition XML files have them specified with 'ds' in front of them. When
loading the XML file, these are removed.

=item B<minfoldsize> => integer

Specifies the minimum size, in lines, of a fold. Default is 1 line.

=item B<newline> => string

Specifies what a newline looks like. By default it is set to "\n". If you are, for example, parsing to HTML you might want to 
set it to "</br>\n".

=item B<substitutions> ref to hash

After matching the text B<HighlightAndFormat> looks here if any special characters, like tabs and 
spaces, need replacement.

=back

=head1 USER METHODS

=over 4

=item B<Folding>

Corresponds with the B<folding> option. You can set and get the folding depth here. If the folding depth changes from 0 to something
else or vice versa, all the loaded lexers in B<Kamelon> are removed and need to be reloaded.

=item B<Folds>

Returns a reference to the folds hash.

=item B<Format>

Usually called through B<Kamelon>. It turns the parsing and folding information into a textstring and returns it.

=item B<FormatTable>(I<$tagname>);

Returns the format data belonging to $tagname. Used by the B<Builder> module. The data is set through
the B<format_table> option.

=item B<Lines>

Returns a reference to the lines array.

=item B<Reset>

Clears all parser data.

=item B<Substitutions>

Sets and returns a reference to the substitutions hash.

=back

=head1 SYSTEM METHODS

=over 4

=item B<FoldBegin>(I<$regionname>) 

Called By Kamelon when it encounters a beginRegion attribute in a rule.
It collects the line number, the current line that is parsed, and pushes
all that to the fold stack in a hash.

=item B<FoldEnd>(I<$regionname>)

Called By Kamelon when it encounters an endRegion attribute in a rule.
Pulls the top item from the foldhash. It checks if the fold end occurred
in a different line then where it started. If so it passes a valid fold
record to the folds hash with the starting line number as key. 
This hash looks like:
 	$linenumber => {
 		end => $endline,
 		depth => $folddepth,
 		line => $text,
 		region => $regionname,
 	}

=item B<FoldStackLevel>

Returns the nesting depth of folds.

=item B<FoldStackPull>

Returns the top item on the foldstack and removes it from the stack.

=item B<FoldStackPush>(I<$reftohash>)

Pushes $reftohash to the fold stack.

=item B<FoldStackTop>

Returns top item from the fold stack.

=item B<Parse>(I<@out>)

Called by Kamelon to send the line it just parsed to the formatter.

=back

=head1 AUTHOR AND COPYRIGHT

This module is written and maintained by:

Hans Jeuken < hansjeuken at xs4all dot nl>

Copyright (c) 2017 by Hans Jeuken, all rights reserved.

Published under the GPLV3 license

=head1 SEE ALSO


=cut

